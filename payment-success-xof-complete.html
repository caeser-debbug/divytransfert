<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Divy Transfert - Paiement réussi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        'divy-dark': '#124556',
                        'divy-blue': '#3194db',
                        'divy-light': '#e3f2fd',
                        'lime-green': '#a6e66e'
                    }
                }
            }
        }
    </script>
    <style>
        .success-enter {
            animation: successScale 0.6s ease-out;
        }
        
        @keyframes successScale {
            0% {
                transform: scale(0.8);
                opacity: 0;
            }
            50% {
                transform: scale(1.1);
                opacity: 0.8;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        .detail-enter {
            animation: slideInUp 0.5s ease-out;
            animation-fill-mode: both;
        }
        
        @keyframes slideInUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .btn-primary {
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            transform: translateY(-2px);
        }
        
        .checkmark {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: block;
            stroke-width: 3;
            stroke: #fff;
            stroke-miterlimit: 10;
            box-shadow: inset 0px 0px 0px #22c55e;
            animation: fill .4s ease-in-out .4s forwards, scale .3s ease-in-out .9s both;
        }
        
        .checkmark__circle {
            stroke-dasharray: 166;
            stroke-dashoffset: 166;
            stroke-width: 3;
            stroke-miterlimit: 10;
            stroke: #22c55e;
            fill: none;
            animation: stroke 0.6s cubic-bezier(0.65, 0, 0.45, 1) forwards;
        }
        
        .checkmark__check {
            transform-origin: 50% 50%;
            stroke-dasharray: 48;
            stroke-dashoffset: 48;
            animation: stroke 0.3s cubic-bezier(0.65, 0, 0.45, 1) 0.8s forwards;
        }
        
        @keyframes stroke {
            100% {
                stroke-dashoffset: 0;
            }
        }
        
        @keyframes scale {
            0%, 100% {
                transform: none;
            }
            50% {
                transform: scale3d(1.1, 1.1, 1);
            }
        }
        
        @keyframes fill {
            100% {
                box-shadow: inset 0px 0px 0px 30px #22c55e;
            }
        }
        
        .copy-animation {
            animation: copyPulse 0.3s ease-out;
        }
        
        @keyframes copyPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body class="antialiased transition-colors duration-300 dark:bg-gray-900 bg-gray-50">
    <div class="min-h-screen flex flex-col bg-gray-50 dark:bg-gray-900">
        <!-- Header -->
        <div class="flex justify-end p-4 pt-12">
            <button onclick="window.location.href='home.html'" class="p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition-colors">
                <svg class="w-6 h-6 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>

        <!-- Contenu principal -->
        <div class="flex-1 flex flex-col items-center justify-center px-4 -mt-16">
            <!-- Animation de succès -->
            <div class="success-enter mb-8">
                <svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52">
                    <circle class="checkmark__circle" fill="none" cx="26" cy="26" r="25"/>
                    <path class="checkmark__check" fill="none" d="m14.1 27.2l7.1 7.2 16.7-16.8"/>
                </svg>
            </div>
            
            <!-- Montant et message -->
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-gray-800 dark:text-white mb-4" id="amount-display">150 000 XOF</h1>
                <p class="text-xl text-gray-800 dark:text-white mb-2" id="recipient-text">Envoyé à Ronald Richards</p>
                <p class="text-gray-600 dark:text-gray-400" id="recipient-email">ronald.richards@gmail.com</p>
            </div>
        </div>

        <!-- Détails de la transaction -->
        <div class="detail-enter bg-white dark:bg-gray-800 rounded-t-3xl shadow-lg px-6 py-8" style="animation-delay: 0.4s">
            <div class="max-w-md mx-auto">
                <!-- Détails -->
                <div class="space-y-4 mb-8">
                    <div class="flex justify-between items-center py-3 border-b border-gray-200 dark:border-gray-700">
                        <span class="text-gray-600 dark:text-gray-400">Vous avez envoyé</span>
                        <span class="font-semibold text-gray-800 dark:text-white" id="detail-amount">150 000 XOF</span>
                    </div>
                    
                    <div class="flex justify-between items-center py-3 border-b border-gray-200 dark:border-gray-700">
                        <span class="text-gray-600 dark:text-gray-400">À</span>
                        <span class="font-semibold text-gray-800 dark:text-white" id="detail-recipient">Ronald Richards</span>
                    </div>
                    
                    <div class="flex justify-between items-center py-3 border-b border-gray-200 dark:border-gray-700">
                        <span class="text-gray-600 dark:text-gray-400">Email</span>
                        <span class="font-semibold text-gray-800 dark:text-white" id="detail-email">ronald.richards@gmail.com</span>
                    </div>
                    
                    <div class="flex justify-between items-center py-3 border-b border-gray-200 dark:border-gray-700">
                        <span class="text-gray-600 dark:text-gray-400">Date</span>
                        <span class="font-semibold text-gray-800 dark:text-white" id="transaction-date"></span>
                    </div>
                    
                    <div class="flex justify-between items-center py-3 border-b border-gray-200 dark:border-gray-700">
                        <span class="text-gray-600 dark:text-gray-400">ID de transaction</span>
                        <div class="flex items-center">
                            <span class="font-mono text-sm font-semibold text-gray-800 dark:text-white mr-2" id="transaction-id">241220230815</span>
                            <button onclick="copyToClipboard(document.getElementById('transaction-id').textContent, this)" class="p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded">
                                <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <div class="flex justify-between items-center py-3 border-b border-gray-200 dark:border-gray-700">
                        <span class="text-gray-600 dark:text-gray-400">ID de référence</span>
                        <div class="flex items-center">
                            <span class="font-mono text-sm font-semibold text-gray-800 dark:text-white mr-2" id="reference-id">F7H2K0X7</span>
                            <button onclick="copyToClipboard(document.getElementById('reference-id').textContent, this)" class="p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded">
                                <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <div class="py-3">
                        <span class="text-gray-600 dark:text-gray-400 block mb-2">Notes</span>
                        <span class="text-gray-800 dark:text-white" id="transaction-notes">Facture de conception d'application de bureau</span>
                    </div>
                </div>

                <!-- Boutons d'action -->
                <div class="space-y-3">
                    <button onclick="downloadReceipt()" class="btn-secondary w-full py-4 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-xl font-semibold">
                        Télécharger le reçu
                    </button>
                    
                    <button onclick="shareReceipt()" class="btn-primary w-full py-4 bg-lime-green text-black rounded-xl font-semibold">
                        Partager le reçu
                    </button>
                </div>
            </div>
        </div>

        <!-- Theme toggle button -->
        <button id="theme-toggle" class="fixed top-4 left-4 p-2 rounded-full bg-white dark:bg-gray-800 shadow-lg z-10">
            <svg id="light-icon" class="w-5 h-5 hidden dark:block text-gray-800" fill="currentColor" viewBox="0 0 20 20">
                <path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"></path>
            </svg>
            <svg id="dark-icon" class="w-5 h-5 block dark:hidden text-gray-600" fill="currentColor" viewBox="0 0 20 20">
                <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
            </svg>
        </button>
    </div>

    <script>
        let transactionData = {};

        document.addEventListener('DOMContentLoaded', function() {
            getUrlParams();
            
            // Gestion du thème
            if (localStorage.getItem('theme') === 'dark' || 
                (!localStorage.getItem('theme') && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark');
            }
            
            document.getElementById('theme-toggle').addEventListener('click', function() {
                if (document.documentElement.classList.contains('dark')) {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('theme', 'light');
                } else {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('theme', 'dark');
                }
            });
        });

        // Récupérer les paramètres de l'URL
        function getUrlParams() {
            const urlParams = new URLSearchParams(window.location.search);
            transactionData = {
                name: urlParams.get('name') || 'Ronald Richards',
                amount: urlParams.get('amount') || '150000',
                email: urlParams.get('email') || 'ronald.richards@gmail.com',
                type: urlParams.get('type') || 'sent',
                notes: urlParams.get('notes') || 'Facture de conception d\'application de bureau'
            };
            
            displayTransactionDetails();
        }

        function displayTransactionDetails() {
            // Mettre à jour les montants avec formatage XOF
            const amount = parseInt(transactionData.amount);
            const formattedAmount = `${amount.toLocaleString('fr-FR')} XOF`;
            document.getElementById('amount-display').textContent = formattedAmount;
            document.getElementById('detail-amount').textContent = formattedAmount;
            
            // Mettre à jour les noms et emails
            document.getElementById('recipient-text').textContent = `Envoyé à ${transactionData.name}`;
            document.getElementById('recipient-email').textContent = transactionData.email;
            document.getElementById('detail-recipient').textContent = transactionData.name;
            document.getElementById('detail-email').textContent = transactionData.email;
            
            // Mettre à jour les notes
            document.getElementById('transaction-notes').textContent = transactionData.notes;
            
            // Afficher la date et l'heure actuelles
            const now = new Date();
            const dateStr = now.toLocaleDateString('fr-FR', {
                day: '2-digit',
                month: 'long',
                year: 'numeric'
            });
            const timeStr = now.toLocaleTimeString('fr-FR', {
                hour: '2-digit',
                minute: '2-digit'
            });
            document.getElementById('transaction-date').textContent = `${dateStr} • ${timeStr}`;
            
            // Générer les IDs
            const transactionId = generateTransactionId();
            const referenceId = generateReferenceId();
            
            document.getElementById('transaction-id').textContent = transactionId;
            document.getElementById('reference-id').textContent = referenceId;
        }

        function generateTransactionId() {
            const now = new Date();
            const day = String(now.getDate()).padStart(2, '0');
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const year = now.getFullYear();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            
            return `${day}${month}${year}${hours}${minutes}`;
        }

        function generateReferenceId() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let result = '';
            for (let i = 0; i < 8; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        function copyToClipboard(text, button) {
            navigator.clipboard.writeText(text).then(() => {
                button.classList.add('copy-animation');
                setTimeout(() => {
                    button.classList.remove('copy-animation');
                }, 300);
                
                // Afficher une notification temporaire
                const notification = document.createElement('div');
                notification.className = 'fixed top-20 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white px-4 py-2 rounded-full shadow-lg z-50';
                notification.textContent = 'Copié !';
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 2000);
            });
        }

        function shareReceipt() {
            if (navigator.share) {
                const shareData = {
                    title: 'Reçu DivyTransfert',
                    text: `Paiement de ${parseInt(transactionData.amount).toLocaleString('fr-FR')} XOF envoyé à ${transactionData.name} via DivyTransfert`,
                    url: window.location.href
                };
                
                navigator.share(shareData).catch(console.error);
            } else {
                // Fallback pour les navigateurs qui ne supportent pas l'API Web Share
                const receiptText = `
Reçu DivyTransfert
Montant: ${parseInt(transactionData.amount).toLocaleString('fr-FR')} XOF
Envoyé à: ${transactionData.name}
Email: ${transactionData.email}
Date: ${document.getElementById('transaction-date').textContent}
Transaction ID: ${document.getElementById('transaction-id').textContent}
                `.trim();
                
                if (navigator.clipboard) {
                    navigator.clipboard.writeText(receiptText).then(() => {
                        showNotification('Reçu copié dans le presse-papiers');
                    });
                } else {
                    showNotification('Partage non supporté sur ce navigateur');
                }
            }
        }

        function downloadReceipt() {
            // Créer un contenu de reçu formaté
            const receiptContent = `
DIVY TRANSFERT - REÇU DE PAIEMENT
=====================================

Date: ${document.getElementById('transaction-date').textContent}
Montant envoyé: ${parseInt(transactionData.amount).toLocaleString('fr-FR')} XOF
Destinataire: ${transactionData.name}
Email: ${transactionData.email}

Transaction ID: ${document.getElementById('transaction-id').textContent}
Référence: ${document.getElementById('reference-id').textContent}

Notes: ${transactionData.notes}

=====================================
Merci d'utiliser Divy Transfert
            `.trim();

            // Créer et télécharger le fichier
            const blob = new Blob([receiptContent], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `recu_paiement_${document.getElementById('transaction-id').textContent}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showNotification('Reçu téléchargé avec succès');
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'fixed top-20 left-1/2 transform -translate-x-1/2 bg-lime-green text-black px-6 py-3 rounded-full shadow-lg z-50 font-semibold';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (document.body.contains(notification)) {
                    document.body.removeChild(notification);
                }
            }, 3000);
        }
    </script>
</body>
</html>